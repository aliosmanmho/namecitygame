<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="/bootstrap/dist/css/bootstrap.min.css" type="text/css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="/bootstrap/dist/js/bootstrap.min.js"  type="text/javascript" ></script>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        var socket = io();
        
        socket.on('GameList', function (gameListObj) {
            var data = JSON.parse(gameListObj);
            if (data !== null) {
                $('#gameList').empty();
                data.forEach(game => {
                    $("<li id=li" + game.id + " class='list-group-item d-flex justify-content-between align-items-center' >Oyun : " + game.id + "</li>").appendTo('#gameList');
                    $("<span class='badge badge-primary badge-pill'>" + game.maxPlayer + "</span>").appendTo('#li' + game.id);
                    $("<button onclick='GameButton(\"" + game.id + "\")' type='button' class='btn btn-primary'>Oyna</button>").appendTo('#li' + game.id);
                }
                );
                var myGame= jQuery.map(data, function(obj) {
                        if(obj.createSocetID === socket.id)
                            return obj; // or return obj.name, whatever.
                    });
                    if(myGame!=null && myGame.length>0)
                    {
                       var gameid= myGame[0].id;
                       GameButton(gameid);
                    }
            }
        });
        function CreateGame(){
            socket.emit("CreateGame","");
        }
        function GameButton(gameId) {
            location.href = "game.html?" + gameId;
        }

        $(document).ready(function () {

        });

    </script>
</head>

<body>
    <h1>İsim Şehir</h1>
    <button onclick='CreateGame()' type='button' class='btn btn-primary'>Oyna</button>
    <ul id="gameList" class="list-group">
        <li class="list-group-item d-flex justify-content-between align-items-center">
            Cras justo odio
            <span class="badge badge-primary badge-pill">14</span>
        </li>
        <li class="list-group-item d-flex justify-content-between align-items-center">
            Dapibus ac facilisis in
            <span class="badge badge-primary badge-pill">2</span>
        </li>
        <li class="list-group-item d-flex justify-content-between align-items-center">
            Morbi leo risus
            <span class="badge badge-primary badge-pill">1</span>
        </li>
    </ul>
</body>

</html>